{"version":3,"file":"fxd-select.auto.umd.min.js","sources":["../src/core/model.js","../src/core/utils.js","../src/core/render.js","../src/core/filter.js","../src/core/events.js","../src/core/FxdSelect.js","../src/auto.js"],"sourcesContent":["export function parseSelect(selectEl) {\n  const options = [];\n\n  selectEl.querySelectorAll('option').forEach((opt) => {\n    options.push({\n      value: opt.value,\n      label: opt.textContent,\n      selected: opt.selected,\n      disabled: opt.disabled,\n      group: opt.parentElement?.tagName === 'OPTGROUP' ? opt.parentElement.label : null,\n      element: opt,\n    });\n  });\n\n  return options;\n}\n\nexport function normalizeOptions(data, selectEl) {\n  if (!Array.isArray(data)) return [];\n\n  const selectedValues = selectEl?.multiple\n    ? new Set(Array.from(selectEl.selectedOptions).map((opt) => opt.value))\n    : new Set([selectEl?.value]);\n\n  return data.map((item) => {\n    const value = item.value ?? '';\n    const label = item.label ?? String(value);\n    const selected = typeof item.selected === 'boolean'\n      ? item.selected\n      : selectedValues.has(value);\n\n    return {\n      value,\n      label,\n      selected,\n      disabled: Boolean(item.disabled),\n      group: item.group ?? null,\n      element: null,\n    };\n  });\n}\n\nexport function buildModel(selectEl, options = {}) {\n  if (Array.isArray(options.data)) {\n    return normalizeOptions(options.data, selectEl);\n  }\n  return parseSelect(selectEl);\n}\n\nexport function syncSelectWithModel(selectEl, model) {\n  const currentGroups = new Map();\n  selectEl.innerHTML = '';\n\n  model.forEach((opt) => {\n    let parent = selectEl;\n    if (opt.group) {\n      if (!currentGroups.has(opt.group)) {\n        const groupEl = document.createElement('optgroup');\n        groupEl.label = opt.group;\n        currentGroups.set(opt.group, groupEl);\n        selectEl.appendChild(groupEl);\n      }\n      parent = currentGroups.get(opt.group);\n    }\n\n    const optionEl = document.createElement('option');\n    optionEl.value = opt.value;\n    optionEl.textContent = opt.label;\n    optionEl.disabled = Boolean(opt.disabled);\n    optionEl.selected = Boolean(opt.selected);\n    parent.appendChild(optionEl);\n  });\n}\n","let idCounter = 0;\n\nexport function createId(prefix) {\n  idCounter += 1;\n  return `${prefix}-${idCounter}`;\n}\n\nexport function addClasses(el, classString) {\n  if (!classString) return;\n  classString.split(' ').forEach((c) => {\n    if (c) el.classList.add(c);\n  });\n}\n\nexport function dispatchEvent(el, name, detail = {}) {\n  el.dispatchEvent(new CustomEvent(name, { detail, bubbles: true }));\n}\n\nlet bootstrapChecked = false;\nlet bootstrapCheckScheduled = false;\n\nexport function warnIfMissingBootstrap(major = 5) {\n  if (bootstrapChecked || bootstrapCheckScheduled) return;\n  if (typeof window === 'undefined' || typeof document === 'undefined') return;\n\n  const runCheck = () => {\n    bootstrapCheckScheduled = false;\n    if (bootstrapChecked) return;\n\n    const rootStyles = getComputedStyle(document.documentElement);\n    const bsBodyColor = rootStyles.getPropertyValue('--bs-body-color').trim();\n    const bsBodyBg = rootStyles.getPropertyValue('--bs-body-bg').trim();\n    const hasBootstrap = bsBodyColor.length > 0 || bsBodyBg.length > 0;\n\n    if (!hasBootstrap) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `fxd-select: Bootstrap ${major}.x styles not detected. ` +\n        'The component will still work, but you should provide your own styles.'\n      );\n    }\n\n    bootstrapChecked = true;\n  };\n\n  bootstrapCheckScheduled = true;\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => requestAnimationFrame(runCheck), { once: true });\n  } else {\n    requestAnimationFrame(runCheck);\n  }\n}\n","import { addClasses, createId } from './utils.js';\n\nfunction updateButtonLabel(ui, model, options, selectEl) {\n  if (typeof options.renderValue === 'function') {\n    const rendered = options.renderValue(model, selectEl);\n    if (rendered instanceof HTMLElement) {\n      ui.button.innerHTML = '';\n      ui.button.appendChild(rendered);\n      return;\n    }\n    ui.button.innerHTML = rendered ?? '';\n    return;\n  }\n\n  const selected = model.filter((opt) => opt.selected);\n  if (selected.length === 0) {\n    ui.button.textContent = options.placeholder;\n    return;\n  }\n\n  if (selectEl.multiple) {\n    if (options.multiValueStyle === 'pills') {\n      const container = document.createElement('span');\n      container.className = options.pillContainerClass;\n\n      const max = Math.max(0, options.maxDisplayItems);\n      const visibleLimit = max + 1;\n      const visibleLabels = selected.slice(0, Math.min(selected.length, visibleLimit));\n      visibleLabels.forEach((opt) => {\n        const pill = document.createElement('span');\n        pill.className = options.pillClass;\n        pill.textContent = opt.label;\n        container.appendChild(pill);\n      });\n\n      const remaining = selected.length - visibleLabels.length;\n      if (remaining > 0) {\n        const count = document.createElement('span');\n        count.className = options.selectionCountClass;\n        const tpl = options.selectionCountTemplate;\n        count.textContent = typeof tpl === 'function' ? tpl(remaining) : `${remaining} selected`;\n        container.appendChild(count);\n      }\n\n      ui.button.innerHTML = '';\n      ui.button.appendChild(container);\n      return;\n    }\n\n    if (options.multiValueStyle === 'count') {\n      const tpl = options.selectionCountTemplate;\n      const text = typeof tpl === 'function' ? tpl(selected.length) : `${selected.length} selected`;\n      ui.button.innerHTML = `<span class=\"${options.selectionCountClass}\">${text}</span>`;\n      return;\n    }\n\n    const max = Math.max(0, options.maxDisplayItems);\n    const visibleLimit = max + 1;\n    if (selected.length > visibleLimit) {\n      const remaining = selected.length - visibleLimit;\n      const tpl = options.selectionCountTemplate;\n      ui.button.textContent = typeof tpl === 'function' ? tpl(remaining) : `${remaining} selected`;\n      return;\n    }\n    ui.button.textContent = selected.map((opt) => opt.label).join(', ');\n    return;\n  }\n\n  ui.button.textContent = selected[0].label;\n}\n\nexport function render(selectEl, model, options, existingUi = null) {\n  const ui = existingUi || {};\n\n  if (!existingUi) {\n    ui.wrapper = document.createElement('div');\n    ui.wrapper.className = 'dropdown fxd-select';\n    addClasses(ui.wrapper, options.wrapperClass);\n\n    ui.control = document.createElement('div');\n    ui.control.className = 'd-flex align-items-center gap-1';\n\n    ui.button = document.createElement('button');\n    ui.button.type = 'button';\n    ui.button.className = options.buttonClass;\n    ui.button.setAttribute('role', 'combobox');\n    ui.button.setAttribute('aria-haspopup', 'listbox');\n    ui.button.setAttribute('aria-expanded', 'false');\n\n    ui.control.appendChild(ui.button);\n\n    if (options.clearable && !selectEl.multiple) {\n      ui.clearButton = document.createElement('button');\n      ui.clearButton.type = 'button';\n      ui.clearButton.className = options.clearButtonClass;\n      ui.clearButton.setAttribute('aria-label', options.clearButtonLabel);\n      ui.clearButton.textContent = options.clearButtonText;\n      ui.control.appendChild(ui.clearButton);\n    }\n\n    ui.menu = document.createElement('div');\n    ui.menu.className = options.menuClass;\n\n    ui.wrapper.appendChild(ui.control);\n    ui.wrapper.appendChild(ui.menu);\n\n    selectEl.parentNode.insertBefore(ui.wrapper, selectEl.nextSibling);\n  } else {\n    ui.menu.innerHTML = '';\n  }\n\n  ui.list = document.createElement('div');\n  ui.list.id = ui.list.id || createId('fxd-list');\n  ui.list.setAttribute('role', 'listbox');\n\n  ui.button.setAttribute('aria-controls', ui.list.id);\n\n  if (options.searchable) {\n    const searchWrapper = document.createElement('div');\n    const searchContainer = document.createElement('div');\n    const searchInput = document.createElement('input');\n\n    searchContainer.className = 'form-control form-control-sm w-auto d-flex flex-fill align-items-center p-1 m-1';\n    searchInput.className = 'form-control p-0 border-0 rounded-0 shadow-none';\n    searchInput.placeholder = options.filterPlaceholder;\n    searchInput.setAttribute('aria-label', options.filterPlaceholder);\n\n    searchContainer.appendChild(searchInput);\n\n    if (options.searchClearable) {\n      const searchClear = document.createElement('button');\n      searchClear.type = 'button';\n      searchClear.className = `fxd-search-clear ${options.searchClearButtonClass}`;\n      searchClear.setAttribute('aria-label', options.searchClearAriaLabel);\n      searchClear.textContent = options.searchClearIcon;\n      searchContainer.appendChild(searchClear);\n      ui.searchClearButton = searchClear;\n    }\n\n    if (ui.clearButton && ui.clearButton.parentNode && ui.clearButton.parentNode !== ui.control) {\n      ui.clearButton.parentNode.removeChild(ui.clearButton);\n      ui.control.appendChild(ui.clearButton);\n    }\n\n    searchWrapper.appendChild(searchContainer);\n    ui.menu.appendChild(searchWrapper);\n\n    ui.searchInput = searchInput;\n\n    if (options.showDivider) {\n      const divider = document.createElement('hr');\n      divider.className = 'm-0';\n      ui.menu.appendChild(divider);\n    }\n\n    ui.noResults = document.createElement('div');\n    ui.noResults.className = 'no-result text-muted px-2 small d-none';\n    ui.noResults.textContent = options.noResultsText;\n    ui.menu.appendChild(ui.noResults);\n  }\n\n  if (options.maxHeight && options.maxHeight !== 'auto') {\n    ui.list.style.overflowY = 'auto';\n    ui.list.style.maxHeight = options.maxHeight;\n  }\n\n  ui.menu.appendChild(ui.list);\n\n  ui.optionButtons = [];\n\n  let currentGroup = null;\n  model.forEach((opt) => {\n    if (opt.group && opt.group !== currentGroup) {\n      const header = document.createElement('div');\n      header.className = 'dropdown-header';\n      header.textContent = opt.group;\n      header.dataset.group = opt.group;\n      ui.list.appendChild(header);\n      currentGroup = opt.group;\n    }\n\n    if (!opt.group) {\n      currentGroup = null;\n    }\n\n    const item = document.createElement('button');\n    item.type = 'button';\n    item.className = 'dropdown-item fxd-item';\n    item.textContent = opt.label;\n    item.dataset.value = opt.value;\n    item.dataset.group = opt.group || '';\n    item.disabled = opt.disabled;\n    item.setAttribute('role', 'option');\n    item.setAttribute('aria-selected', opt.selected ? 'true' : 'false');\n    item.id = createId('fxd-opt');\n\n    if (options.renderOption) {\n      const rendered = options.renderOption(opt, { selected: opt.selected, disabled: opt.disabled });\n      if (rendered instanceof HTMLElement) {\n        item.innerHTML = '';\n        item.appendChild(rendered);\n      } else if (typeof rendered === 'string') {\n        item.innerHTML = rendered;\n      }\n    }\n\n    if (opt.selected) {\n      item.classList.add('is-selected');\n    }\n\n    if (options.showCheckmark && opt.value !== '') {\n      const check = document.createElement('span');\n      check.className = options.checkmarkClass;\n      check.setAttribute('aria-hidden', 'true');\n      check.textContent = options.checkmarkText;\n      item.appendChild(check);\n    }\n\n    ui.optionButtons.push(item);\n    ui.list.appendChild(item);\n  });\n\n  updateButtonLabel(ui, model, options, selectEl);\n\n  const isDisabled = selectEl.disabled;\n  ui.button.disabled = isDisabled;\n  if (ui.clearButton) ui.clearButton.disabled = isDisabled;\n  if (ui.searchInput) ui.searchInput.disabled = isDisabled;\n  if (ui.searchClearButton) ui.searchClearButton.disabled = isDisabled;\n\n  return ui;\n}\n","export function defaultFilter(query, option) {\n  if (!query) return true;\n  return option.label.toLowerCase().includes(query.toLowerCase());\n}\n\nexport function applyFilter(listEl, query, filterFn) {\n  const groupState = new Map();\n  let hidden = 0;\n  let visible = 0;\n\n  Array.from(listEl.children).forEach((item) => {\n    if (item.classList.contains('dropdown-header')) {\n      groupState.set(item.dataset.group || '', { header: item, visible: 0 });\n      return;\n    }\n\n    if (!item.matches('button.dropdown-item')) return;\n\n    const option = { label: item.textContent };\n    const show = filterFn(query, option);\n    item.classList.toggle('d-none', !show);\n    if (!show) hidden += 1;\n    if (show) visible += 1;\n\n    const groupKey = item.dataset.group || '';\n    if (groupState.has(groupKey) && show) {\n      groupState.get(groupKey).visible += 1;\n    }\n  });\n\n  groupState.forEach(({ header, visible }) => {\n    header.classList.toggle('d-none', visible === 0);\n  });\n\n  return { hidden, visible };\n}\n","import { defaultFilter, applyFilter } from './filter.js';\nimport { normalizeOptions, syncSelectWithModel } from './model.js';\nimport { dispatchEvent } from './utils.js';\n\nexport function bindEvents(fxd) {\n  const { selectEl, ui, options, state } = fxd;\n\n  const getVisibleOptions = () => (\n    Array.from(ui.list.querySelectorAll('button.dropdown-item')).filter(\n      (item) => !item.classList.contains('d-none') && !item.disabled\n    )\n  );\n\n  const setFocusedIndex = (index) => {\n    const optionsList = getVisibleOptions();\n    if (optionsList.length === 0) {\n      state.focusedIndex = -1;\n      ui.button.removeAttribute('aria-activedescendant');\n      return;\n    }\n\n    const clamped = Math.max(0, Math.min(index, optionsList.length - 1));\n    optionsList.forEach((item) => item.classList.remove('active'));\n\n    const focused = optionsList[clamped];\n    focused.classList.add('active');\n    focused.scrollIntoView({ block: 'nearest' });\n\n    state.focusedIndex = clamped;\n    ui.button.setAttribute('aria-activedescendant', focused.id);\n  };\n\n  const focusSelectedOrFirst = () => {\n    const optionsList = getVisibleOptions();\n    if (optionsList.length === 0) return;\n\n    const selectedIndex = optionsList.findIndex(\n      (item) => item.getAttribute('aria-selected') === 'true'\n    );\n\n    setFocusedIndex(selectedIndex >= 0 ? selectedIndex : 0);\n  };\n\n  const onButtonClick = (e) => {\n    if (selectEl.disabled) return;\n    e.preventDefault();\n    fxd.toggle();\n    if (fxd.state.open) {\n      focusSelectedOrFirst();\n      ui.searchInput?.select();\n    }\n  };\n\n  const onDocumentClick = (e) => {\n    if (!ui.wrapper.contains(e.target)) {\n      fxd.close();\n    }\n  };\n\n  const onItemClick = (e) => {\n    const item = e.target.closest('button.dropdown-item');\n    if (!item) return;\n    if (selectEl.disabled || item.disabled) return;\n    if (selectEl.multiple) {\n      const option = Array.from(selectEl.options).find((opt) => opt.value === item.dataset.value);\n      if (option) {\n        option.selected = !option.selected;\n      }\n      selectEl.dispatchEvent(new Event('change', { bubbles: true }));\n    } else {\n      selectEl.value = item.dataset.value;\n      selectEl.dispatchEvent(new Event('change', { bubbles: true }));\n      fxd.close();\n      ui.button.focus();\n    }\n  };\n\n  const onItemHover = (e) => {\n    const item = e.target.closest('button.dropdown-item');\n    if (!item) return;\n\n    const optionsList = getVisibleOptions();\n    const idx = optionsList.indexOf(item);\n    if (idx >= 0) setFocusedIndex(idx);\n  };\n\n  const onSelectChange = () => {\n    fxd.refresh();\n    dispatchEvent(selectEl, 'fxd:change');\n  };\n\n  let loadTimer = null;\n  const runLoad = async (query) => {\n    const data = await options.load?.(query);\n    if (!Array.isArray(data)) return;\n    const model = normalizeOptions(data, selectEl);\n    syncSelectWithModel(selectEl, model);\n    fxd.model = model;\n    fxd.refresh();\n    if (fxd.ui.searchInput) {\n      fxd.ui.searchInput.value = query;\n    }\n  };\n\n  const onFilterInput = (e) => {\n    const query = e.target.value;\n    fxd.state.query = query;\n\n    if (options.load) {\n      if (loadTimer) clearTimeout(loadTimer);\n      loadTimer = setTimeout(() => runLoad(query), options.loadDebounce);\n      return;\n    }\n\n    const filterFn = options.filter || defaultFilter;\n    const result = applyFilter(ui.list, query, filterFn);\n\n    if (ui.noResults) {\n      ui.noResults.classList.toggle('d-none', result.visible > 0);\n    }\n\n    focusSelectedOrFirst();\n  };\n\n  const onKeyDown = (e) => {\n    if (selectEl.disabled) return;\n    const key = e.key;\n    const openKeys = ['ArrowDown', 'ArrowUp', 'Enter', ' '];\n    const navKeys = ['ArrowDown', 'ArrowUp', 'Home', 'End'];\n\n    if (!fxd.state.open && openKeys.includes(key)) {\n      e.preventDefault();\n      fxd.open();\n      focusSelectedOrFirst();\n      ui.searchInput?.select();\n      return;\n    }\n\n    if (!fxd.state.open) return;\n\n    if (key === 'Escape') {\n      e.preventDefault();\n      fxd.close();\n      ui.button.focus();\n      return;\n    }\n\n    if (key === 'Enter') {\n      e.preventDefault();\n      const optionsList = getVisibleOptions();\n      const focused = optionsList[state.focusedIndex];\n      if (focused) {\n        focused.click();\n      }\n      return;\n    }\n\n    if (key === ' ') {\n      e.preventDefault();\n      const optionsList = getVisibleOptions();\n      const focused = optionsList[state.focusedIndex];\n      if (focused) {\n        focused.click();\n      }\n      return;\n    }\n\n    if (navKeys.includes(key)) {\n      e.preventDefault();\n      const optionsList = getVisibleOptions();\n      if (optionsList.length === 0) return;\n\n      if (key === 'Home') {\n        setFocusedIndex(0);\n        return;\n      }\n\n      if (key === 'End') {\n        setFocusedIndex(optionsList.length - 1);\n        return;\n      }\n\n      const delta = key === 'ArrowDown' ? 1 : -1;\n      setFocusedIndex(state.focusedIndex + delta);\n    }\n  };\n\n  const onClearClick = (e) => {\n    e.preventDefault();\n    fxd.clear();\n  };\n\n  const onSearchClearClick = () => {\n    if (!ui.searchInput) return;\n    ui.searchInput.value = '';\n    ui.searchInput.dispatchEvent(new Event('input'));\n    ui.searchInput.select();\n  };\n\n  ui.button.addEventListener('click', onButtonClick);\n  ui.list.addEventListener('click', onItemClick);\n  ui.list.addEventListener('mousemove', onItemHover);\n  document.addEventListener('click', onDocumentClick);\n  selectEl.addEventListener('change', onSelectChange);\n  ui.searchInput?.addEventListener('input', onFilterInput);\n  ui.searchClearButton?.addEventListener('click', onSearchClearClick);\n  ui.wrapper.addEventListener('keydown', onKeyDown);\n  ui.clearButton?.addEventListener('click', onClearClick);\n\n  return () => {\n    ui.button.removeEventListener('click', onButtonClick);\n    ui.list.removeEventListener('click', onItemClick);\n    ui.list.removeEventListener('mousemove', onItemHover);\n    document.removeEventListener('click', onDocumentClick);\n    selectEl.removeEventListener('change', onSelectChange);\n    ui.searchInput?.removeEventListener('input', onFilterInput);\n    ui.searchClearButton?.removeEventListener('click', onSearchClearClick);\n    ui.wrapper.removeEventListener('keydown', onKeyDown);\n    ui.clearButton?.removeEventListener('click', onClearClick);\n  };\n}\n","import { buildModel } from './model.js';\nimport { render } from './render.js';\nimport { bindEvents } from './events.js';\nimport { dispatchEvent, warnIfMissingBootstrap } from './utils.js';\n\nexport class FxdSelect {\n  constructor(selectEl, options = {}) {\n    if (!selectEl || selectEl.tagName !== 'SELECT') {\n      throw new Error('FxdSelect requires a <select> element');\n    }\n\n    this.selectEl = selectEl;\n    this.options = { ...FxdSelect.defaults, ...options };\n    this.state = {\n      open: false,\n      query: '',\n      focusedIndex: -1,\n    };\n\n    this.model = buildModel(this.selectEl, this.options);\n    this.ui = render(this.selectEl, this.model, this.options);\n    this.cleanup = bindEvents(this);\n\n    this.selectEl.classList.add('d-none');\n\n    if (this.options.warnOnMissingBootstrap) {\n      warnIfMissingBootstrap(this.options.bootstrapMajor);\n    }\n\n    dispatchEvent(this.selectEl, 'fxd:init');\n  }\n\n  _syncOpenState(open) {\n    this.state.open = open;\n    if (open) {\n      this.ui.wrapper.classList.add('show');\n      this.ui.menu.classList.add('show');\n      this.ui.button.setAttribute('aria-expanded', 'true');\n    } else {\n      this.ui.wrapper.classList.remove('show');\n      this.ui.menu.classList.remove('show');\n      this.ui.button.setAttribute('aria-expanded', 'false');\n      this.ui.button.removeAttribute('aria-activedescendant');\n      this.state.focusedIndex = -1;\n    }\n  }\n\n  open() {\n    if (this.state.open) return;\n    this._syncOpenState(true);\n    dispatchEvent(this.selectEl, 'fxd:open');\n  }\n\n  close() {\n    if (!this.state.open) return;\n    this._syncOpenState(false);\n    dispatchEvent(this.selectEl, 'fxd:close');\n  }\n\n  toggle() {\n    if (this.state.open) this.close();\n    else this.open();\n  }\n\n  refresh() {\n    const wasOpen = this.state.open;\n    this.cleanup?.();\n    this.model = buildModel(this.selectEl, this.options);\n    this.ui = render(this.selectEl, this.model, this.options, this.ui);\n    this.cleanup = bindEvents(this);\n    this._syncOpenState(wasOpen);\n    if (this.ui.searchInput && this.state.query) {\n      this.ui.searchInput.value = this.state.query;\n      this.ui.searchInput.dispatchEvent(new Event('input'));\n    }\n    dispatchEvent(this.selectEl, 'fxd:refresh');\n  }\n\n  destroy() {\n    this.cleanup?.();\n    this.ui.wrapper.remove();\n    this.selectEl.classList.remove('d-none');\n    dispatchEvent(this.selectEl, 'fxd:destroy');\n  }\n\n  getValue() {\n    return this.selectEl.value;\n  }\n\n  setValue(value) {\n    this.selectEl.value = value;\n    this.selectEl.dispatchEvent(new Event('change', { bubbles: true }));\n  }\n\n  clear() {\n    if (this.selectEl.multiple) {\n      Array.from(this.selectEl.options).forEach((opt) => {\n        opt.selected = false;\n      });\n    } else {\n      this.selectEl.value = '';\n    }\n    this.selectEl.dispatchEvent(new Event('change', { bubbles: true }));\n  }\n}\n\nFxdSelect.defaults = {\n  searchable: true,\n  clearable: false,\n  maxHeight: '12em',\n  placeholder: 'Select...',\n  noResultsText: 'No entries found',\n  buttonClass: 'form-select text-start',\n  wrapperClass: '',\n  menuClass: 'dropdown-menu p-0',\n  filterPlaceholder: 'Search',\n  showDivider: true,\n  renderOption: null,\n  renderValue: null,\n  data: null,\n  load: null,\n  loadDebounce: 250,\n  maxDisplayItems: 3,\n  multiValueStyle: 'pills',\n  selectionCountClass: 'badge bg-secondary',\n  selectionCountTemplate: (count) => `${count} selected`,\n  pillClass: 'badge text-bg-light border',\n  pillContainerClass: 'fxd-pills',\n  clearButtonClass: 'btn btn-outline-secondary btn-sm',\n  clearButtonLabel: 'Clear selection',\n  clearButtonText: '×',\n  searchClearable: true,\n  searchClearButtonClass: 'btn btn-link btn-sm text-decoration-none',\n  searchClearIcon: '×',\n  searchClearAriaLabel: 'Clear search',\n  warnOnMissingBootstrap: true,\n  bootstrapMajor: 5,\n  showCheckmark: true,\n  checkmarkText: '✓',\n  checkmarkClass: 'fxd-checkmark',\n  filter: null,\n};\n","import { FxdSelect } from './core/FxdSelect.js';\n\nconst instanceMap = new WeakMap();\n\nfunction toCamel(str) {\n  return str.replace(/-([a-z])/g, (_, c) => c.toUpperCase());\n}\n\nfunction parseValue(value) {\n  if (value === 'true') return true;\n  if (value === 'false') return false;\n  if (value === 'null') return null;\n  if (value === 'undefined') return undefined;\n  if (value !== '' && !Number.isNaN(Number(value))) return Number(value);\n  if ((value.startsWith('{') && value.endsWith('}')) || (value.startsWith('[') && value.endsWith(']'))) {\n    try {\n      return JSON.parse(value);\n    } catch {\n      return value;\n    }\n  }\n  return value;\n}\n\nfunction optionsFromDataset(dataset) {\n  const options = {};\n  Object.entries(dataset).forEach(([key, value]) => {\n    if (!key.startsWith('fxdsel')) return;\n    const raw = key.replace(/^fxdsel/, '');\n    const prop = toCamel(raw.charAt(0).toLowerCase() + raw.slice(1));\n    options[prop] = parseValue(value);\n  });\n  return options;\n}\n\nexport function initFxdSelects(root = document) {\n  const nodes = root.querySelectorAll('select[data-fxd-select], select.fxd-init-select');\n  nodes.forEach((selectEl) => {\n    if (instanceMap.has(selectEl)) return;\n    const options = optionsFromDataset(selectEl.dataset);\n    const instance = new FxdSelect(selectEl, options);\n    instanceMap.set(selectEl, instance);\n  });\n}\n\nif (typeof document !== 'undefined') {\n  document.addEventListener('DOMContentLoaded', () => {\n    initFxdSelects();\n  });\n}\n\nexport { FxdSelect };\n"],"names":["normalizeOptions","data","selectEl","Array","isArray","selectedValues","multiple","Set","from","selectedOptions","map","opt","value","item","label","String","selected","has","disabled","Boolean","group","element","buildModel","options","querySelectorAll","forEach","push","textContent","parentElement","tagName","parseSelect","idCounter","createId","prefix","dispatchEvent","el","name","detail","CustomEvent","bubbles","bootstrapChecked","bootstrapCheckScheduled","render","model","existingUi","ui","classString","menu","innerHTML","wrapper","document","createElement","className","wrapperClass","split","c","classList","add","control","button","type","buttonClass","setAttribute","appendChild","clearable","clearButton","clearButtonClass","clearButtonLabel","clearButtonText","menuClass","parentNode","insertBefore","nextSibling","list","id","searchable","searchWrapper","searchContainer","searchInput","placeholder","filterPlaceholder","searchClearable","searchClear","searchClearButtonClass","searchClearAriaLabel","searchClearIcon","searchClearButton","removeChild","showDivider","divider","noResults","noResultsText","maxHeight","style","overflowY","optionButtons","currentGroup","header","dataset","renderOption","rendered","HTMLElement","showCheckmark","check","checkmarkClass","checkmarkText","renderValue","filter","length","multiValueStyle","container","pillContainerClass","visibleLimit","Math","max","maxDisplayItems","visibleLabels","slice","min","pill","pillClass","remaining","count","selectionCountClass","tpl","selectionCountTemplate","text","join","updateButtonLabel","isDisabled","defaultFilter","query","option","toLowerCase","includes","bindEvents","fxd","state","getVisibleOptions","contains","setFocusedIndex","index","optionsList","focusedIndex","removeAttribute","clamped","remove","focused","scrollIntoView","block","focusSelectedOrFirst","selectedIndex","findIndex","getAttribute","onButtonClick","e","preventDefault","toggle","open","select","onDocumentClick","target","close","onItemClick","closest","find","Event","focus","onItemHover","idx","indexOf","onSelectChange","refresh","loadTimer","runLoad","async","load","currentGroups","Map","parent","groupEl","set","get","optionEl","syncSelectWithModel","onFilterInput","clearTimeout","setTimeout","loadDebounce","filterFn","result","listEl","groupState","hidden","visible","children","matches","show","groupKey","applyFilter","onKeyDown","key","click","delta","onClearClick","clear","onSearchClearClick","addEventListener","removeEventListener","FxdSelect","constructor","Error","this","defaults","cleanup","warnOnMissingBootstrap","major","window","runCheck","rootStyles","getComputedStyle","documentElement","bsBodyColor","getPropertyValue","trim","bsBodyBg","console","warn","readyState","requestAnimationFrame","once","warnIfMissingBootstrap","bootstrapMajor","_syncOpenState","wasOpen","destroy","getValue","setValue","instanceMap","WeakMap","optionsFromDataset","Object","entries","startsWith","raw","replace","prop","charAt","_","toUpperCase","Number","isNaN","endsWith","JSON","parse","parseValue","initFxdSelects","root","instance"],"mappings":"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"}